import{d as x,a as T,i as l,c as r,M as m,s as p,S as E,b as F,t as i,e as w,u as I,f as W,g as S,o as B,h as R,A as M,j as q,F as P}from"./index.fae669f3.js";import{P as n,M as L,g as O,h as z,t as H,u as J,a as K,L as Q}from"./layout.6bff2fca.js";const U="/tic-tac-toe-gunjs/assets/circle.2c56a12d.svg",V="/tic-tac-toe-gunjs/assets/cross.f03db0bd.svg",X=i('<img alt="circle" class="animate-spawn">'),Y=i('<img alt="cross" class="animate-spawn">'),Z=i('<button class="btn hover-shadow border-8 field flex justify-center items-center m-auto" aria-label="Tic Tac Toe Button"></button>'),ee=a=>(()=>{const o=Z.cloneNode(!0);return T(o,"click",a.onClick,!0),l(o,r(E,{get fallback(){return[]},get children(){return[r(m,{get when(){return a.state===n.Circle},get children(){const c=X.cloneNode(!0);return p(c,"src",U),c}}),r(m,{get when(){return a.state===n.Cross},get children(){const c=Y.cloneNode(!0);return p(c,"src",V),c}})]}})),F(()=>p(o,"tabindex",a.active?0:-1)),o})();x(["click"]);const te=i('<div class="flex flex-col"><h3 class="m-3 text-4xl text-center"></h3><button class="modal-btn hover-scale bg-terra py-2 px-3 m-auto">Restart Game</button></div>'),y=a=>r(L,{foregroundClass:"animate-spawn animation-delay-2000",backgroundClass:"animate-fadein animation-delay-1000",get children(){const o=te.cloneNode(!0),c=o.firstChild,d=c.nextSibling;return l(c,()=>a.result),T(d,"click",a.restartGame,!0),o}});x(["click"]);const re=i('<div class="text-center mx-auto">Could not find lobby</div>'),ne=i('<div><div class="grid grid-cols-3 grid-rows-3 gap-4 aspect-square"></div><div class="flex flex-row justify-center align-middle gap-x-3"><button class="btn hover-shadow border-4 my-4 py-2 px-4"></button></div></div>'),ae=()=>{const[a,o]=w(Array.from({length:9},()=>n.None)),[c,d]=w(n.Circle);let u=I().query.id;const[C]=W(async()=>u?await K(u):!1),$=O(u);$.get("field").on(t=>{const e=Object.values(t),s=e.slice(0,e.length-1);o(s)}),$.get("turn").on(t=>{d(t)});let g=n.None;const h=S(()=>{const t=z(a());return t!==n.None&&(g=n.None),t}),f=t=>{let e=a(),s=c();g===n.None&&(g=s),s===g&&e[t]===n.None&&(e[t]=s,o([...e]),s=H(s),d(s),k())},N=t=>{if(t.code.startsWith("Digit")){const e=parseInt(t.code.charAt(t.code.length-1))-1;e>=0&&f(e)}else if(t.code.startsWith("Numpad")){let e=parseInt(t.code.charAt(t.code.length-1));e>=7&&e<=9&&(e-=6),e>=1&&e<=3&&(e+=6),e-=1,e>=0&&f(e)}};B(()=>{window.addEventListener("keydown",N)}),R(()=>{window.removeEventListener("keydown",N)});const b=()=>{o(Array.from({length:9},()=>n.None)),d(n.Circle),g=n.None,k()},k=()=>{J(u,{field:a(),turn:c()})},[j,_]=w(!1);let v;return(()=>{const t=ne.cloneNode(!0),e=t.firstChild,s=e.nextSibling,G=s.firstChild;return l(t,r(q,{get when(){return S(()=>!C.loading,!0)()&&!C()},get children(){return r(L,{get children(){return[re.cloneNode(!0),r(M,{href:"/",class:"modal-btn hover-scale bg-terra px-4 py-2 block",children:"Back to Main Menu"})]}})}}),e),l(e,r(P,{get each(){return a()},children:(A,D)=>r(ee,{get active(){return h()===n.None},state:A,onClick:()=>f(D())})})),l(t,r(E,{get children(){return[r(m,{get when(){return h()===n.Circle},get children(){return r(y,{restartGame:b,result:"Winner: Circle"})}}),r(m,{get when(){return h()===n.Cross},get children(){return r(y,{restartGame:b,result:"Winner: Cross"})}}),r(m,{get when(){return h()===n.Draw},get children(){return r(y,{restartGame:b,result:"Draw"})}})]}}),s),G.$$click=()=>{_(!0),v&&clearTimeout(v),v=setTimeout(()=>{_(!1)},5*1e3),navigator.clipboard.writeText(u)},l(G,()=>j()?"Game ID Copied!":"Get Game ID"),l(s,r(M,{href:"/",class:"btn hover-shadow border-4 my-4 py-2 px-4",children:"Leave Game"}),null),t})()};x(["click"]);const le=()=>r(Q,{get children(){return r(ae,{})}});export{le as default};
